<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChatterBox Pay</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="w-full h-screen bg-black flex flex-col items-center justify-center relative overflow-hidden">
    <div id="razorpay" class="w-full h-full bg-black flex flex-col lg:flex-row items-center justify-center">
      
      <!-- Input Form -->
      <div
        id="input-pay"
        class="w-[90%] sm:w-[60%] md:w-[40%] lg:w-[30%] h-auto mt-6 lg:mt-0 lg:h-[70%] relative rounded-[30px] shadow-[2px_2px_15px_2px_rgb(255,117,117)] hover:rounded-[50px] transition-all duration-500"
      >
        <div class="logo-icon w-full flex justify-center pt-4">
          <img
            src="/images/chatterBox_2-removebg-preview.png"
            alt=""
            class="w-40 h-32"
          />
        </div>

        <form action="" method="post" class="w-full px-6 py-4">
          <p id="pay-title" class="text-white text-center text-lg sm:text-xl mb-4">
            Pay with ChatterBox
          </p>

          <div class="flex justify-center mb-4">
            <input
              type="amount"
              name="amount"
              placeholder="₹ 0"
              class="w-full max-w-[250px] h-[70px] text-4xl text-center text-white bg-black border border-black rounded-full focus:outline-none hover:text-3xl"
            />
          </div>

          <div class="flex justify-center mb-4">
            <input
              type="text"
              name="text"
              placeholder="Send message..."
              class="w-full max-w-[200px] h-[50px] text-sm text-center text-white bg-black border border-black rounded-full focus:outline-none"
            />
          </div>

          <div class="flex justify-center">
            <button
              id="rzp-button1"
              class="px-6 py-3 bg-green-700 text-white rounded-full border border-black hover:bg-black hover:text-gray-300 hover:shadow-[1px_1px_5px_1px_rgb(255,117,117)] hover:border-2 hover:border-black transition-all cursor-pointer"
            >
              Pay now
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
      document.getElementById("rzp-button1").onclick = function (e) {
        e.preventDefault();
        const amount = document.querySelector('input[name="amount"]').value;

        if (!amount || isNaN(amount) || amount <= 0) {
          alert("Please enter a valid amount.");
          return;
        }

        const options = {
          key: "rzp_test_7749S2PqTQkQDq",
          amount: amount * 100,
          currency: "INR",
          name: "ChatterBox",
          description: "Test Transaction",
          handler: function (response) {
            console.log("Payment Successful, Creating Order...", response);

            axios
              .post("http://localhost:4000/pay/create/orderId", {
                amount: amount,
                razorpayOrderId: response.razorpay_order_id,
                razorpayPaymentId: response.razorpay_payment_id,
                signature: response.razorpay_signature,
              })
              .then((res) => {
                alert("Payment Successfully 👍");
                console.log("Order Response:", res.data);
              })
              .catch((error) => {
                console.error("Order creation error:", error.response?.data || error.message);
                alert("Failed to create order. Please try again.");
              });
          },
          prefill: {
            name: "Vikash kumar",
            email: "vikashku6107@gmail.com",
            contact: "9598256108",
          },
          theme: { color: "#3399cc" },
        };

        var rzp1 = new Razorpay(options);
        rzp1.open();
      };
    </script>
  </body>
</html>
